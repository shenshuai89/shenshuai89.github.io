---
title: 06-è®¾ç½®æ•°æ®åº“
date: 2024-06-24 17:27:46
permalink: /pages/9911e5/
author: 
  name: åŒ—é¸Ÿå—æ¸¸
  link: https://shenshuai89.github.io/
---
åŸæ–‡é“¾æ¥ï¼š[https://nextjs.org/learn/dashboard-app/setting-up-your-database](https://nextjs.org/learn/dashboard-app/setting-up-your-database)
åœ¨æ‚¨å¯ä»¥ç»§ç»­ä½¿ç”¨ dashboard ä¹‹å‰ï¼Œä½ éœ€è¦ä¸€äº›æ•°æ®ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨`@vercel/postgres`è®¾ç½®PostgreSQLæ•°æ®åº“ã€‚å¦‚æœä½ å·²ç»ç†Ÿæ‚‰PostgreSQLï¼Œå¹¶ä¸”æ›´å–œæ¬¢ä½¿ç”¨è‡ªå·±çš„æ•°æ®åº“ï¼Œä½ å¯ä»¥è·³è¿‡è¿™ä¸€ç« ï¼Œè‡ªå·±è®¾ç½®ã€‚å¦åˆ™ï¼Œè®©æˆ‘ä»¬ç»§ç»­ï¼
## æœ¬ç« ç›®æ ‡

- æ¨é€é¡¹ç›®ä»£ç åˆ°github
- å»ºç«‹ä¸€ä¸ªVercelå¸æˆ·å¹¶é“¾æ¥æ‚¨çš„GitHubå›è´­ä»¥è¿›è¡Œå³æ—¶é¢„è§ˆå’Œéƒ¨ç½²ã€‚
- åˆ›å»ºé¡¹ç›®å¹¶å°†å…¶é“¾æ¥åˆ°Postgresæ•°æ®åº“ã€‚
- ä½¿ç”¨seedjsä¸ºæ•°æ®åº“è®¾å®šæ•°æ®ã€‚
## åˆ›å»ºGitHubå­˜å‚¨åº“
é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°†æ‚¨çš„å­˜å‚¨åº“æ¨é€åˆ°Githubï¼ˆå¦‚æœæ‚¨è¿˜æ²¡æœ‰è¿™æ ·åšçš„è¯ï¼‰ã€‚è¿™å°†ä½¿æ‚¨çš„æ•°æ®åº“è®¾ç½®å’Œéƒ¨ç½²æ›´åŠ å®¹æ˜“ã€‚
å¦‚æœæ‚¨éœ€è¦å¸®åŠ©è®¾ç½®å­˜å‚¨åº“ï¼Œè¯·å‚é˜…GitHubä¸Šçš„[æ­¤æŒ‡å—](https://docs.github.com/en/repositories/creating-and-managing-repositories/quickstart-for-repositories)ã€‚
## åˆ›å»ºVercelå¸æˆ·
è®¿é—®[vercel.com/signup](https://vercel.com/signup)åˆ›å»ºå¸æˆ·ã€‚é€‰æ‹©å…è´¹çš„â€œhobbyâ€è®¡åˆ’ã€‚é€‰æ‹©ç»§ç»­ä½¿ç”¨GitHubè¿æ¥æ‚¨çš„GitHubå’ŒVercelå¸æˆ·ã€‚
## è¿æ¥å¹¶éƒ¨ç½²æ‚¨çš„é¡¹ç›®
æ¥ä¸‹æ¥ï¼Œæ‚¨å°†è¿›å…¥è¿™ä¸ªå±å¹•ï¼Œåœ¨é‚£é‡Œæ‚¨å¯ä»¥é€‰æ‹©å¹¶å¯¼å…¥åˆšåˆšåˆ›å»ºçš„GitHubå­˜å‚¨åº“ï¼š
![image.png](https://cdn.nlark.com/yuque/0/2024/png/737887/1719135292416-eb3c8f41-f940-43a3-96fd-601c42683069.png#averageHue=%23e5e5e5&clientId=u159495f9-0052-4&from=paste&height=533&id=u3742b62a&originHeight=1065&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=381838&status=done&style=shadow&taskId=ud35f8aba-ef23-4d34-901e-cfc464be6fc&title=&width=960)
å‘½åæ‚¨çš„é¡¹ç›®ï¼Œç„¶åå•å‡»â€œéƒ¨ç½²â€ã€‚
![image.png](https://cdn.nlark.com/yuque/0/2024/png/737887/1719135313447-35c08261-8454-4e7a-b0a7-2cbc0d5a72ff.png#averageHue=%23e9e8e8&clientId=u159495f9-0052-4&from=paste&height=514&id=u2c06111e&originHeight=1027&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=322688&status=done&style=shadow&taskId=u69d20456-b8c8-46a3-b32f-79ecd90a4e6&title=&width=960)
å¥½æäº†ğŸ‰ ç°åœ¨å·²éƒ¨ç½²æ‚¨çš„é¡¹ç›®ã€‚
![image.png](https://cdn.nlark.com/yuque/0/2024/png/737887/1719135331233-b340a0b2-f81a-44ec-9a2e-838de5da489e.png#averageHue=%23e5e5e5&clientId=u159495f9-0052-4&from=paste&height=502&id=u780e52ab&originHeight=1004&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=355012&status=done&style=shadow&taskId=u02f173ac-0c9e-4b36-b9ca-a26782eb772&title=&width=960)
é€šè¿‡è¿æ¥æ‚¨çš„GitHubå­˜å‚¨åº“ï¼Œæ¯å½“æ‚¨å°†æ›´æ”¹æ¨é€åˆ°ä¸»åˆ†æ”¯æ—¶ï¼ŒVercelå°†è‡ªåŠ¨é‡æ–°éƒ¨ç½²æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œæ— éœ€ä»»ä½•é…ç½®ã€‚æ‰“å¼€æ‹‰å–è¯·æ±‚æ—¶ï¼Œæ‚¨è¿˜å¯ä»¥è¿›è¡Œå³æ—¶é¢„è§ˆï¼Œä»¥ä¾¿å°½æ—©å‘ç°éƒ¨ç½²é”™è¯¯ï¼Œå¹¶ä¸å›¢é˜Ÿæˆå‘˜å…±äº«é¡¹ç›®é¢„è§ˆä»¥è·å¾—åé¦ˆã€‚
## åˆ›å»ºPostgresæ•°æ®åº“
æ¥ä¸‹æ¥ï¼Œè¦è®¾ç½®æ•°æ®åº“ï¼Œè¯·å•å‡»â€œ`**Continue to Dashboard** `â€ï¼Œç„¶åä»é¡¹ç›®é¢æ¿ä¸­é€‰æ‹©â€œ**Storage**â€é€‰é¡¹å¡ã€‚é€‰æ‹©**Connect Store** â†’ **Create New** â†’ **Postgres** â†’ **Continue**.
![image.png](https://cdn.nlark.com/yuque/0/2024/png/737887/1719135488756-982bb7ea-cf8f-4f2b-8797-e6c3f1fd2f73.png#averageHue=%23c4c2c2&clientId=u159495f9-0052-4&from=paste&height=535&id=u13a9bc14&originHeight=1069&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=366671&status=done&style=shadow&taskId=u7ed76659-ad03-4bbb-bc19-7b36a338055&title=&width=960)
æ¥å—æ¡æ¬¾ï¼Œä¸ºæ•°æ®åº“æŒ‡å®šåç§°ï¼›å¹¶ç¡®ä¿æ‚¨çš„æ•°æ®åº“åŒºåŸŸè®¾ç½®ä¸ºWashington D.Cï¼ˆiad1ï¼‰-è¿™ä¹Ÿæ˜¯æ‰€æœ‰æ–°Vercelé¡¹ç›®çš„é»˜è®¤åŒºåŸŸã€‚
é€šè¿‡å°†æ•°æ®åº“æ”¾ç½®åœ¨åŒä¸€åŒºåŸŸæˆ–é è¿‘åº”ç”¨ç¨‹åºä»£ç ã€è¿™é‡Œå¯ä»¥é€‰æ‹©ä¸€ä¸ªäºšæ´²çš„ã€‘ï¼Œå¯ä»¥å‡å°‘æ•°æ®è¯·æ±‚çš„å»¶è¿Ÿã€‚![image.png](https://cdn.nlark.com/yuque/0/2024/png/737887/1719135697736-5a48b0a9-dad4-44ff-8738-b462de9d9699.png#averageHue=%23f2f2f2&clientId=u159495f9-0052-4&from=paste&height=425&id=uc9ee37d9&originHeight=850&originWidth=1470&originalType=binary&ratio=2&rotation=0&showTitle=false&size=136526&status=done&style=shadow&taskId=uf9713f7d-007f-44bd-b1cb-f0f0b17a95a&title=&width=735)
> ç‰¹åˆ«æç¤ºï¼šä¸€æ—¦æ•°æ®åº“åŒºåŸŸåˆå§‹åŒ–ï¼Œå°±ä¸èƒ½æ›´æ”¹å®ƒã€‚å¦‚æœæ‚¨å¸Œæœ›ä½¿ç”¨ä¸åŒçš„åŒºåŸŸï¼Œåˆ™åº”åœ¨åˆ›å»ºæ•°æ®åº“ä¹‹å‰è¿›è¡Œè®¾ç½®ã€‚

è¿æ¥åï¼Œå¯¼èˆªåˆ°`.env.local`tabï¼Œç‚¹å‡»`**Show secret** `**å’Œ**`**Copy Snippet**`**ï¼Œå¤åˆ¶å‡ºæ¥**
![image.png](https://cdn.nlark.com/yuque/0/2024/png/737887/1719135936142-3177c547-dc38-4a58-bf89-5906080c9ed1.png#averageHue=%23eae9e9&clientId=u159495f9-0052-4&from=paste&height=387&id=u3c02bcce&originHeight=773&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=356707&status=done&style=shadow&taskId=uaa955d24-3462-4b28-bce4-ca0aa656ff5&title=&width=960)
å¯¼èˆªåˆ°ä»£ç ç¼–è¾‘å™¨å¹¶é‡å‘½åæ–‡ä»¶ `.env.example`ä¸º`.env`ï¼Œç²˜è´´ä»Vercelå¤åˆ¶çš„æ•°æ®åº“å¯†ç å†…å®¹ã€‚
> é‡è¦çš„æç¤ºï¼š
> æŸ¥çœ‹`.gitignore`æ–‡ä»¶ç¡®ä¿å·²ç»æ·»åŠ äº†`.env`çš„é…ç½®ï¼Œè¿™ä¸ªå°±é¿å…å°†å¯†ç é…ç½®æ–‡ä»¶ä¸Šä¼ åˆ°githubã€‚

æœ€åï¼Œåœ¨æ‚¨çš„ç»ˆç«¯ä¸­è¿è¡Œ`pnpm i @vercel/postgres`æ¥å®‰è£… `[Vercel Postgres SDK](https://vercel.com/docs/storage/vercel-postgres/sdk).`
## åˆå§‹åŒ–æ•°æ®åº“
ç°åœ¨æ‚¨çš„æ•°æ®åº“å·²ç»åˆ›å»ºï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä¸€äº›åˆå§‹æ•°æ®å¯¹å…¶è¿›è¡Œæœ€åˆè®¾ç½®ã€‚è¿™å°†åˆ›å»ºæ‚¨åœ¨æ„å»ºä»ªè¡¨æ¿æ—¶ä½¿ç”¨ä¸€äº›æ•°æ®ã€‚
åœ¨é¡¹ç›®çš„`/scripts`æ–‡ä»¶å¤¹ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º`seed.js`çš„æ–‡ä»¶ã€‚æ­¤è„šæœ¬åŒ…å«åˆ›å»ºå’Œè®¾å®šæœ€åˆæ•°æ®çš„è¯´æ˜`invoices`ã€`customers`ã€`user`ã€`revenue`è¡¨ã€‚
å¦‚æœæ‚¨ä¸äº†è§£ä»£ç æ‰€åšçš„ä¸€åˆ‡ï¼Œè¯·ä¸è¦æ‹…å¿ƒï¼Œä½†è¦ç»™æ‚¨ä¸€ä¸ªæ¦‚è¿°ã€‚è¯¥è„šæœ¬ä½¿ç”¨SQLåˆ›å»ºè¡¨ï¼Œå¹¶åœ¨åˆ›å»ºè¡¨åä½¿ç”¨`placeholder-data.js`æ–‡ä»¶ä¸­çš„æ•°æ®å¡«å……è¡¨ã€‚
æ¥ä¸‹æ¥ï¼Œåœ¨æ‚¨çš„package.jsonæ–‡ä»¶ä¸­ï¼Œå°†seedè¡Œæ·»åŠ åˆ°è„šæœ¬ä¸­ï¼š
```tsx
"scripts": {
  "build": "next build",
  "dev": "next dev",
  "start": "next start",
  "seed": "node -r dotenv/config ./scripts/seed.js"
},
```
è¿™æ˜¯å°†æ‰§è¡Œ`seed.js`çš„å‘½ä»¤ã€‚
ç°åœ¨ï¼Œè¿è¡Œ`pnpm seed`ã€‚æ‚¨åº”è¯¥åœ¨ç»ˆç«¯ä¸­çœ‹åˆ°ä¸€äº›`console.log`æ—¥å¿—æ¶ˆæ¯ï¼Œè®©æ‚¨çŸ¥é“è„šæœ¬æ­£åœ¨è¿è¡Œã€‚
## æµè§ˆæ•°æ®åº“
è®©æˆ‘ä»¬çœ‹çœ‹æ‚¨çš„æ•°æ®åº“æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚è¿”å›åˆ°Vercelï¼Œç„¶åå•å‡»ä¾§å¯¼èˆªä¸Šçš„æ•°æ®ã€‚
åœ¨æœ¬èŠ‚ä¸­ï¼Œæ‚¨å°†æ‰¾åˆ°å››ä¸ªæ–°è¡¨ï¼šusers, customers, invoices, and revenueã€‚
![image.png](https://cdn.nlark.com/yuque/0/2024/png/737887/1719193596164-8fcad9c3-b884-4893-a9cb-5d54e457d630.png#averageHue=%23f9f9f9&clientId=u452f394d-b5c1-4&from=paste&height=395&id=u18137bf4&originHeight=790&originWidth=1924&originalType=binary&ratio=2&rotation=0&showTitle=false&size=82723&status=done&style=shadow&taskId=u59cd215b-97b9-42ee-8965-f49d1d33440&title=&width=962)
é€šè¿‡é€‰æ‹©æ¯ä¸ªè¡¨ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å…¶è®°å½•ï¼Œå¹¶ç¡®ä¿æ¡ç›®ä¸`placeholder-data.js`æ–‡ä»¶ä¸­çš„æ•°æ®å¯¹é½ã€‚
## æ‰§è¡ŒæŸ¥è¯¢
æ‚¨å¯ä»¥åˆ‡æ¢åˆ°â€œæŸ¥è¯¢â€é€‰é¡¹å¡ä»¥ä¸æ•°æ®åº“äº¤äº’ã€‚æœ¬èŠ‚æ”¯æŒæ ‡å‡†SQLå‘½ä»¤ã€‚
ä¾‹å¦‚è¾“å…¥`DROP TABLE customers`å°†åˆ é™¤â€œå®¢æˆ·â€è¡¨åŠå…¶æ‰€æœ‰æ•°æ®ï¼Œæ‰€ä»¥è¦**_å°å¿ƒ_**ï¼
è®©æˆ‘ä»¬è¿è¡Œæ‚¨çš„ç¬¬ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢ã€‚å°†ä»¥ä¸‹SQLä»£ç ç²˜è´´å¹¶è¿è¡Œåˆ°Vercelæ¥å£ä¸­ï¼š
```sql
SELECT invoices.amount, customers.name
FROM invoices
JOIN customers ON invoices.customer_id = customers.id
WHERE invoices.amount = 666;
```






