(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{346:function(t,e,s){"use strict";s.r(e);var a=s(7),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("原文链接："),e("a",{attrs:{href:"https://nextjs.org/learn/dashboard-app/setting-up-your-database",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://nextjs.org/learn/dashboard-app/setting-up-your-database"),e("OutboundLink")],1),t._v("\n在您可以继续使用 dashboard 之前，你需要一些数据。在本章中，您将使用"),e("code",[t._v("@vercel/postgres")]),t._v("设置PostgreSQL数据库。如果你已经熟悉PostgreSQL，并且更喜欢使用自己的数据库，你可以跳过这一章，自己设置。否则，让我们继续！")]),t._v(" "),e("h2",{attrs:{id:"本章目标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本章目标"}},[t._v("#")]),t._v(" 本章目标")]),t._v(" "),e("ul",[e("li",[t._v("推送项目代码到github")]),t._v(" "),e("li",[t._v("建立一个Vercel帐户并链接您的GitHub回购以进行即时预览和部署。")]),t._v(" "),e("li",[t._v("创建项目并将其链接到Postgres数据库。")]),t._v(" "),e("li",[t._v("使用seedjs为数据库设定数据。")])]),t._v(" "),e("h2",{attrs:{id:"创建github存储库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建github存储库"}},[t._v("#")]),t._v(" 创建GitHub存储库")]),t._v(" "),e("p",[t._v("首先，让我们将您的存储库推送到Github（如果您还没有这样做的话）。这将使您的数据库设置和部署更加容易。\n如果您需要帮助设置存储库，请参阅GitHub上的"),e("a",{attrs:{href:"https://docs.github.com/en/repositories/creating-and-managing-repositories/quickstart-for-repositories",target:"_blank",rel:"noopener noreferrer"}},[t._v("此指南"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"创建vercel帐户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建vercel帐户"}},[t._v("#")]),t._v(" 创建Vercel帐户")]),t._v(" "),e("p",[t._v("访问"),e("a",{attrs:{href:"https://vercel.com/signup",target:"_blank",rel:"noopener noreferrer"}},[t._v("vercel.com/signup"),e("OutboundLink")],1),t._v("创建帐户。选择免费的“hobby”计划。选择继续使用GitHub连接您的GitHub和Vercel帐户。")]),t._v(" "),e("h2",{attrs:{id:"连接并部署您的项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#连接并部署您的项目"}},[t._v("#")]),t._v(" 连接并部署您的项目")]),t._v(" "),e("p",[t._v("接下来，您将进入这个屏幕，在那里您可以选择并导入刚刚创建的GitHub存储库：\n"),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/737887/1719135292416-eb3c8f41-f940-43a3-96fd-601c42683069.png#averageHue=%23e5e5e5&clientId=u159495f9-0052-4&from=paste&height=533&id=u3742b62a&originHeight=1065&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=381838&status=done&style=shadow&taskId=ud35f8aba-ef23-4d34-901e-cfc464be6fc&title=&width=960",alt:"image.png"}}),t._v("\n命名您的项目，然后单击“部署”。\n"),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/737887/1719135313447-35c08261-8454-4e7a-b0a7-2cbc0d5a72ff.png#averageHue=%23e9e8e8&clientId=u159495f9-0052-4&from=paste&height=514&id=u2c06111e&originHeight=1027&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=322688&status=done&style=shadow&taskId=u69d20456-b8c8-46a3-b32f-79ecd90a4e6&title=&width=960",alt:"image.png"}}),t._v("\n好极了🎉 现在已部署您的项目。\n"),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/737887/1719135331233-b340a0b2-f81a-44ec-9a2e-838de5da489e.png#averageHue=%23e5e5e5&clientId=u159495f9-0052-4&from=paste&height=502&id=u780e52ab&originHeight=1004&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=355012&status=done&style=shadow&taskId=u02f173ac-0c9e-4b36-b9ca-a26782eb772&title=&width=960",alt:"image.png"}}),t._v("\n通过连接您的GitHub存储库，每当您将更改推送到主分支时，Vercel将自动重新部署您的应用程序，无需任何配置。打开拉取请求时，您还可以进行即时预览，以便尽早发现部署错误，并与团队成员共享项目预览以获得反馈。")]),t._v(" "),e("h2",{attrs:{id:"创建postgres数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建postgres数据库"}},[t._v("#")]),t._v(" 创建Postgres数据库")]),t._v(" "),e("p",[t._v("接下来，要设置数据库，请单击“"),e("code",[t._v("**Continue to Dashboard**")]),t._v("”，然后从项目面板中选择“"),e("strong",[t._v("Storage")]),t._v("”选项卡。选择"),e("strong",[t._v("Connect Store")]),t._v(" → "),e("strong",[t._v("Create New")]),t._v(" → "),e("strong",[t._v("Postgres")]),t._v(" → "),e("strong",[t._v("Continue")]),t._v(".\n"),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/737887/1719135488756-982bb7ea-cf8f-4f2b-8797-e6c3f1fd2f73.png#averageHue=%23c4c2c2&clientId=u159495f9-0052-4&from=paste&height=535&id=u13a9bc14&originHeight=1069&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=366671&status=done&style=shadow&taskId=u7ed76659-ad03-4bbb-bc19-7b36a338055&title=&width=960",alt:"image.png"}}),t._v("\n接受条款，为数据库指定名称；并确保您的数据库区域设置为Washington D.C（iad1）-这也是所有新Vercel项目的默认区域。\n通过将数据库放置在同一区域或靠近应用程序代码【这里可以选择一个亚洲的】，可以减少数据请求的延迟。"),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/737887/1719135697736-5a48b0a9-dad4-44ff-8738-b462de9d9699.png#averageHue=%23f2f2f2&clientId=u159495f9-0052-4&from=paste&height=425&id=uc9ee37d9&originHeight=850&originWidth=1470&originalType=binary&ratio=2&rotation=0&showTitle=false&size=136526&status=done&style=shadow&taskId=uf9713f7d-007f-44bd-b1cb-f0f0b17a95a&title=&width=735",alt:"image.png"}})]),t._v(" "),e("blockquote",[e("p",[t._v("特别提示：一旦数据库区域初始化，就不能更改它。如果您希望使用不同的区域，则应在创建数据库之前进行设置。")])]),t._v(" "),e("p",[t._v("连接后，导航到"),e("code",[t._v(".env.local")]),t._v("tab，点击"),e("code",[t._v("**Show secret**")]),e("strong",[t._v("和")]),e("code",[t._v("**Copy Snippet**")]),e("strong",[t._v("，复制出来")]),t._v(" "),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/737887/1719135936142-3177c547-dc38-4a58-bf89-5906080c9ed1.png#averageHue=%23eae9e9&clientId=u159495f9-0052-4&from=paste&height=387&id=u3c02bcce&originHeight=773&originWidth=1920&originalType=binary&ratio=2&rotation=0&showTitle=false&size=356707&status=done&style=shadow&taskId=uaa955d24-3462-4b28-bce4-ca0aa656ff5&title=&width=960",alt:"image.png"}}),t._v("\n导航到代码编辑器并重命名文件 "),e("code",[t._v(".env.example")]),t._v("为"),e("code",[t._v(".env")]),t._v("，粘贴从Vercel复制的数据库密码内容。")]),t._v(" "),e("blockquote",[e("p",[t._v("重要的提示：\n查看"),e("code",[t._v(".gitignore")]),t._v("文件确保已经添加了"),e("code",[t._v(".env")]),t._v("的配置，这个就避免将密码配置文件上传到github。")])]),t._v(" "),e("p",[t._v("最后，在您的终端中运行"),e("code",[t._v("pnpm i @vercel/postgres")]),t._v("来安装 "),e("code",[t._v("[Vercel Postgres SDK](https://vercel.com/docs/storage/vercel-postgres/sdk).")])]),t._v(" "),e("h2",{attrs:{id:"初始化数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#初始化数据库"}},[t._v("#")]),t._v(" 初始化数据库")]),t._v(" "),e("p",[t._v("现在您的数据库已经创建，让我们使用一些初始数据对其进行最初设置。这将创建您在构建仪表板时使用一些数据。\n在项目的"),e("code",[t._v("/scripts")]),t._v("文件夹中，有一个名为"),e("code",[t._v("seed.js")]),t._v("的文件。此脚本包含创建和设定最初数据的说明"),e("code",[t._v("invoices")]),t._v("、"),e("code",[t._v("customers")]),t._v("、"),e("code",[t._v("user")]),t._v("、"),e("code",[t._v("revenue")]),t._v("表。\n如果您不了解代码所做的一切，请不要担心，但要给您一个概述。该脚本使用SQL创建表，并在创建表后使用"),e("code",[t._v("placeholder-data.js")]),t._v("文件中的数据填充表。\n接下来，在您的package.json文件中，将seed行添加到脚本中：")]),t._v(" "),e("div",{staticClass:"language-tsx line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-tsx"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"scripts"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"build"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"next build"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"dev"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"next dev"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"start"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"next start"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"seed"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node -r dotenv/config ./scripts/seed.js"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("p",[t._v("这是将执行"),e("code",[t._v("seed.js")]),t._v("的命令。\n现在，运行"),e("code",[t._v("pnpm seed")]),t._v("。您应该在终端中看到一些"),e("code",[t._v("console.log")]),t._v("日志消息，让您知道脚本正在运行。")]),t._v(" "),e("h2",{attrs:{id:"浏览数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览数据库"}},[t._v("#")]),t._v(" 浏览数据库")]),t._v(" "),e("p",[t._v("让我们看看您的数据库是什么样子的。返回到Vercel，然后单击侧导航上的数据。\n在本节中，您将找到四个新表：users, customers, invoices, and revenue。\n"),e("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2024/png/737887/1719193596164-8fcad9c3-b884-4893-a9cb-5d54e457d630.png#averageHue=%23f9f9f9&clientId=u452f394d-b5c1-4&from=paste&height=395&id=u18137bf4&originHeight=790&originWidth=1924&originalType=binary&ratio=2&rotation=0&showTitle=false&size=82723&status=done&style=shadow&taskId=u59cd215b-97b9-42ee-8965-f49d1d33440&title=&width=962",alt:"image.png"}}),t._v("\n通过选择每个表，您可以查看其记录，并确保条目与"),e("code",[t._v("placeholder-data.js")]),t._v("文件中的数据对齐。")]),t._v(" "),e("h2",{attrs:{id:"执行查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行查询"}},[t._v("#")]),t._v(" 执行查询")]),t._v(" "),e("p",[t._v("您可以切换到“查询”选项卡以与数据库交互。本节支持标准SQL命令。\n例如输入"),e("code",[t._v("DROP TABLE customers")]),t._v("将删除“客户”表及其所有数据，所以要**"),e("em",[t._v("小心")]),t._v("**！\n让我们运行您的第一个数据库查询。将以下SQL代码粘贴并运行到Vercel接口中：")]),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" invoices"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amount"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" customers"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" invoices\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" customers "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" invoices"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("customer_id "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" customers"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" invoices"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amount "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("666")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])])}),[],!1,null,null,null);e.default=r.exports}}]);