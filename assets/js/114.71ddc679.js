(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{429:function(t,r,a){"use strict";a.r(r);var s=a(7),o=Object(s.a)({},(function(){var t=this,r=t._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("p",[t._v("主要有 3 种工具来搭建 npm 私服：nexus、verdaccio 以及 cnpm；下面主要介绍 verdaccio 的使用。")]),t._v(" "),r("h2",{attrs:{id:"一、安装、启动"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#一、安装、启动"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("一、安装、启动")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("Verdaccio 的安装启动过程较为简单。首先是全局安装 Verdaccio：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[t._v("npm i "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g verdaccio\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("在终端中输入 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("verdaccio")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 命令启动 Verdaccio：")])],1),t._v(" "),r("p",[r("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2022/png/737887/1652875701174-da052990-e89e-4653-a145-5e3c5b493f67.png",alt:"demo"}})]),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("终端中输出提示，输出它的配置文件位置、启动的服务地址等信息：")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("默认 Verdaccio 启动的服务都会在 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("4873")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 这个端口，在浏览器中打开这个地址我们就会看到 Verdaccio 搭建的私有库 npm 的界面")])],1),t._v(" "),r("p",[r("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2022/png/737887/1652875772434-aebd1d3d-a305-4c49-93bb-1058ce8469ab.png",alt:""}})]),t._v(" "),r("h2",{attrs:{id:"二、配置修改"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#二、配置修改"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("二、配置修改")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("在生产环境下，私有 npm 库需要具备以下 3 个功能：")])],1),t._v(" "),r("ul",[r("li",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("支持对 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("npm")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 包的搜索")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("严格的权限把控，")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("npm")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("包的访问只能是已注册的用户。并且在一些场景下，需要删除用户")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("发布 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("npm")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 包后，推送到钉钉群，告知哪个 npm 包进行了发布")])],1)]),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("Verdaccio 的配置文件是在 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("~/.config/Verdaccio")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 文件夹的 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("config.yaml")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 文件，默认的配置会是这样：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("storage")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("storage\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("plugins\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("web")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("title")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Verdaccio\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("auth")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("htpasswd")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("file")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("htpasswd\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("uplinks")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("npmjs")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" https"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("registry.npmjs.org")]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("packages")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'@*/*'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("access")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $all\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("publish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unpublish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("proxy")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npmjs\n  "),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'**'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("access")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $all\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("publish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unpublish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("proxy")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npmjs\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("server")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("keepAliveTimeout")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("middlewares")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("audit")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("enabled")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("logs")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" stdout"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("format")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" pretty"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("level")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br"),r("span",{staticClass:"line-number"},[t._v("12")]),r("br"),r("span",{staticClass:"line-number"},[t._v("13")]),r("br"),r("span",{staticClass:"line-number"},[t._v("14")]),r("br"),r("span",{staticClass:"line-number"},[t._v("15")]),r("br"),r("span",{staticClass:"line-number"},[t._v("16")]),r("br"),r("span",{staticClass:"line-number"},[t._v("17")]),r("br"),r("span",{staticClass:"line-number"},[t._v("18")]),r("br"),r("span",{staticClass:"line-number"},[t._v("19")]),r("br"),r("span",{staticClass:"line-number"},[t._v("20")]),r("br"),r("span",{staticClass:"line-number"},[t._v("21")]),r("br"),r("span",{staticClass:"line-number"},[t._v("22")]),r("br"),r("span",{staticClass:"line-number"},[t._v("23")]),r("br"),r("span",{staticClass:"line-number"},[t._v("24")]),r("br"),r("span",{staticClass:"line-number"},[t._v("25")]),r("br"),r("span",{staticClass:"line-number"},[t._v("26")]),r("br"),r("span",{staticClass:"line-number"},[t._v("27")]),r("br"),r("span",{staticClass:"line-number"},[t._v("28")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("逐个认识一下默认配置中的几个值的含义：")])],1),t._v(" "),r("ul",[r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("storage")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("已发布的包的存储位置，默认存储在")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("~/.config/Verdaccio/")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("文件夹下")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("plugins")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("插件所在的目录")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("web")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("界面相关的配置")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("auth")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("用户相关，例如注册、鉴权插件（默认使用的是")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("htpasswd")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("）")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("uplinks")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("用于提供对外部包的访问，例如访问 npm、cnpm 对应的源")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("packages")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("用于配置发布包、删除包、查看包的权限")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("server")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("私有库服务端相关的配置")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("middlewares")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("中间件相关配置，默认会引入")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("auit")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("中间件，来支持")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("npm audit")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("命令")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("logs")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 终端输出的信息的配置")])],1)]),t._v(" "),r("h3",{attrs:{id:"_2-1-开启搜索"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-开启搜索"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("2.1 开启搜索")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("当我们私有 npm 库存在很多包的时候，我们想要查找某个包就会有些麻烦。而 Verdaccio 是支持搜索功能的，它是由")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("search")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("控制的，默认为")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("false")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("，所以这里我们需要开启它：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("search")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" \n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("开启之后，我们就可以在私有 npm 库的页面上的搜索栏进行正常的搜索操作。")])],1),t._v(" "),r("h3",{attrs:{id:"_2-2-权限把控"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-权限把控"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("2.2 权限把控")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("权限把控指的是我们需要私有 npm 库上发布的包")]),r("strong",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("只能团队成员查看")])],1),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("，除此之外人员不能看到一切信息。那么，回到 Verdaccio，我们需要做这 2 件事：")])],1),t._v(" "),r("ul",[r("li",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("限制 npm 包的查看，只能为已注册的用户")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("禁止用户注册（在团队成员已注册完成后）")])],1)]),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("相应地，这里我们需要修改配置文件的")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("pacakges")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("和")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("auth")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("。前面我们也提及了")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("packages")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("是用于配置发布包、查看包、删除包相关的权限。我们先再来看看默认的配置：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("packages")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'@*/*'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("access")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $all\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("publish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unpublish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("proxy")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npmjs\n  "),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'**'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("access")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $all\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("publish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unpublish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("proxy")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npmjs\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("这里的 key 代表对应权限需要匹配的包名，例如对于第一个，如果我们发布的包名是这样的")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("@wjc/test")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("就会命中。每个规则中对应 4 个参数。其中")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("proxy")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("代表如果在私有 npm 库找不到，则会代理到 npmjs（对应")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("unlinks")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("中的")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("npmjs")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("的")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("https://registry.npmjs.org/")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("）。而剩下的 3 个参数，都是用来设置包相关的权限，它有三个可选值")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("$all")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("（所有人）、")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("$anonymous")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("（未注册用户）、")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("$authenticated")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("（注册用户）。那么，下面我们分别看一下这 3 个参数的含义：")])],1),t._v(" "),r("ul",[r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("access")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("控制包的访问权限")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("publish")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("控制包的发布权限")])],1),t._v(" "),r("li",[r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("unpublish")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("控制包的删除权限")])],1)]),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("显然，这里我们需要的是只有用户才能具备上述 3 个权限，即都设置为 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("$authenticated")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("packages")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'@*/*'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("access")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("publish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unpublish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("proxy")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npmjs\n  "),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'**'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("access")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("publish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("unpublish")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" $authenticated\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("proxy")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" npmjs\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br"),r("span",{staticClass:"line-number"},[t._v("7")]),r("br"),r("span",{staticClass:"line-number"},[t._v("8")]),r("br"),r("span",{staticClass:"line-number"},[t._v("9")]),r("br"),r("span",{staticClass:"line-number"},[t._v("10")]),r("br"),r("span",{staticClass:"line-number"},[t._v("11")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("设置好")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("packages")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("后，我们还得更改")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("auth")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("的值，因为此时注册用户是没有限制的，也就是说如果你的私有 npm 库部署在外网环境的话，任何人都可以通过")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("npm adduser")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("命令注册用户。")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("显然，这是不允许出现的情况，所以这里我们需要设置")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("auth")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("的")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("max_users")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("为")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("-1")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("，它代表的是禁用注册用户：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("auth")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("max_users")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br")])]),r("blockquote",[r("p",[t._v("开启注册，设置大于0就可以；")])]),t._v(" "),r("h3",{attrs:{id:"_2-3-发布包推送钉钉群或企微"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-发布包推送钉钉群或企微"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("2.3 发布包推送钉钉群或企微")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("发布包推送钉钉群，指的是我们每次发布包可以通过钉钉群的机器人来通知我们发布的包的信息。")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("首先，这里我们需要先有一个钉钉群的机器人对应的 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("Webhook")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("（获取方式可以查看钉钉的文档）。然后，在 Verdaccio 的配置文件中添加 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("notify")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("notify")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n  "),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'dingtalk'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("method")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token constant"}},[t._v("POST")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("headers")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),r("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'Content-Type'")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json;charset=utf-8'")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("endpoint")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" https"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("oapi"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dingtalk"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("robot"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("send"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("access_token"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" # 钉钉机器人的 webhook\n    "),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("content")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"color":"green","message":"新的包发布了: * {{ name }}*","notify":true,"message_format":"text"}\'')]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br"),r("span",{staticClass:"line-number"},[t._v("6")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("其中，")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("method")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("和")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("headers")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("分别表示请求的方法和实体的类型。")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("endpoint")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("表示请求的")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("Webhook")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("地址。")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("content")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("则表示获取发布信息的基础模版，模版中")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("message")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("的值会是钉钉群的机器人发送的消息内容（")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("name")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}}),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("表示发布的包名）。")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("假设，此时我们发布了一个包名为 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("ming-pro")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 的私有包，相应地我们会在钉钉群里收到通知：")])],1),t._v(" "),r("h2",{attrs:{id:"基本使用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基本使用"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("基本使用")])],1),t._v(" "),r("h3",{attrs:{id:"_3-1-注册用户"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-注册用户"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("3.1 注册用户")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("首先，我们需要注册一个用户：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[t._v("npm adduser "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("registry http"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("localhost:4873")]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2022/png/737887/1652876370820-2a5eedd9-9b5e-43ad-b77c-15a203e962c0.png",alt:""}}),r("br"),t._v("\n注册成功后，就可以到端口4873登陆。")]),t._v(" "),r("h3",{attrs:{id:"_3-2-删除用户"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-删除用户"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("3.2 删除用户")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("既然有注册用户，不可避免的需求是在一些场景下，我们需要删除某个用户来禁止其登陆私有 npm 库。")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("前面也提及了 Verdaccio 默认使用的是 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("htpasswd")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 来实现鉴权。相应地，注册的用户信息会存储在 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("~/.config/verdaccio/htpasswd")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 文件中："),r("br")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[t._v("MacBook"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Pro verdaccio "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" cat htpasswd \n"),r("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("shenshuai")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("f9TW"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("3Gxq42Dc"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("autocreated "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("05")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("18T10"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("471Z\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("这里一条记录对应一个用户，也就是如果这条记录被删除了，那么该用户就不能登陆了，即删除了该用户。")])],1),t._v(" "),r("h3",{attrs:{id:"_3-3-添加、切换源"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-添加、切换源"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("3.3 添加、切换源")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("通过 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("nrm")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 来切换源")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[t._v("nrm add shuai http"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex"}},[r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),r("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("localhostm:4873")]),r("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("这里的 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("shuai")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 代表你这个源的简称，你可以因自己的喜好来命名。")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("接着，我们可以运行 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("nrm ls")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 命令来查看目前存在的源：")]),r("br"),t._v(" "),r("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2022/png/737887/1652876550762-699a848e-9868-4fc0-882e-2ccc05ac02aa.png",alt:""}}),r("br"),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("默认情况下 npm 使用的源是 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("https://registry.npmjs.org/")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("，那么这里我们需要将它切换成私有 npm 库对应的源：")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[t._v("nrm use shuai\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("切换好源后，我们之后的 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("npm i")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v(" 就会")]),r("strong",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("先去私有库查找包")])],1),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("，如果不存在则会去 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("https://registry.npmjs.org/")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("（因为上面配置了 ")]),r("font",{staticStyle:{color:"rgb(248, 35, 117)","background-color":"rgb(248, 248, 248)"}},[t._v("proxy")]),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("）查找包。")])],1),t._v(" "),r("h3",{attrs:{id:"_3-4-发布"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-发布"}},[t._v("#")]),t._v(" "),r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("3.4 发布")])],1),t._v(" "),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("发布的话就直接在某个需要发布包的项目")])],1),t._v(" "),r("div",{staticClass:"language-javascript line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-javascript"}},[r("code",[t._v("npm publish\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("font",{staticStyle:{color:"rgb(85, 85, 85)"}},[t._v("在私有 npm 库的界面上就可以看到我们发布的包：")]),r("br"),t._v(" "),r("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2022/png/737887/1652876675144-18c12c74-ea47-4b74-b68e-468c6b75e38a.png",alt:""}})],1)])}),[],!1,null,null,null);r.default=o.exports}}]);